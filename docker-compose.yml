version: '3.8'

services:
  server:
    build: .
    container_name: ghostnet-server
    environment:
      - GHOSTNET_SERVER_IP=0.0.0.0
      - GHOSTNET_SERVER_PORT=53
      - GHOSTNET_ENCRYPTION_KEY=${GHOSTNET_ENCRYPTION_KEY:-standard-test-key-32-chars-long!}
    ports:
      - "53:53/udp"
    networks:
      - ghostnet-net

  client-tester:
    build: .
    container_name: ghostnet-client
    environment:
      - GHOSTNET_SERVER_IP=server
      - GHOSTNET_SERVER_PORT=53
      - GHOSTNET_ENCRYPTION_KEY=${GHOSTNET_ENCRYPTION_KEY:-standard-test-key-32-chars-long!}
    depends_on:
      - server
    networks:
      - ghostnet-net
    command: [ "tail", "-f", "/dev/null" ] # Keep alive for manual testing

networks:
  ghostnet-net:
    driver: bridge
